(()=>{"use strict";new Swiper(".swiper",{slidesPerView:4,slidesPerGroup:4,loop:!0,observer:!0,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});const e=document.getElementById("searchInput"),t=document.getElementById("searchBtn"),n=document.getElementById("moviesList"),s=document.getElementById("watchlist"),i=document.getElementById("favorites"),a=document.getElementById("favorites_btn"),c=document.getElementById("mainBlock");function l(e,t){return e.some((function(e){return t==e}))}async function o(){const t=await fetch(`https://www.omdbapi.com/?s=${e.value.trim()}&apikey=d1075702`),s=await t.json();"False"==s.Response&&alert(s.Error),n.innerHTML="",function(e){e.Search.forEach((async e=>{let t=await fetch(`https://www.omdbapi.com/?i=${e.imdbID}&apikey=e668e570`),s=await t.json();const i=`${s.imdbID}watchlistBtn`,a=document.createElement("div");a.classList.add("swiper-slide"),a.innerHTML=`\n\n    <div class="card" id=${s.imdbID}>\n\n        <span id=${s.imdbID} class="hide movie-key">${s.imdbID}key</span>\n        <span class="card-title">${e.Title}</span>\n        <img src=${e.Poster} class="card-poster" />\n\n\n        <div class="card-header">\n          <div class="card-info">\n            <span class="card-year">${e.Year}</span>\n            <button class="card-btn-favorietes" id="${i}watchlistBtn"><svg class="like" viewBox="0 0 612 792" width="100%" height="100%"><path d="M562.413,284.393c-9.68,41.044-32.121,78.438-64.831,108.07L329.588,542.345l-165.11-149.843 c-32.771-29.691-55.201-67.076-64.892-108.12c-6.965-29.484-4.103-46.14-4.092-46.249l0.147-0.994 c6.395-72.004,56.382-124.273,118.873-124.273c46.111,0,86.703,28.333,105.965,73.933l9.061,21.477l9.061-21.477 c18.958-44.901,61.694-73.922,108.896-73.922c62.481,0,112.478,52.27,119,125.208C566.517,238.242,569.379,254.908,562.413,284.393z"/></svg></button>\n          </div>\n        </div>\n\n        <div class="card-rating">\n          <img src="../images/star-icon.png" class="star-icon" />\n          <span>${s.imdbRating}</span>\n        </div>\n\n    </div>\n    `,n.appendChild(a),document.getElementById(`${i}watchlistBtn`).addEventListener("click",(e=>{!function(e){const t=e.target.closest("path"),n=t.closest("div.swiper-slide"),s=t.closest("div.card");l(Object.keys(localStorage),`${s.id}key`)?(localStorage.removeItem(`${s.id}key`,n.innerHTML),e.target.closest("path").classList.remove("inWatchlist")):(e.target.closest("path").classList.add("inWatchlist"),localStorage.setItem(`${s.id}key`,n.innerHTML))}(e)})),function(e){if(localStorage.length){const t=Object.keys(localStorage);for(let n=0;n<e.length;n++){let s=e[n];l(t,`${s.id}key`)&&s.childNodes[7].childNodes[1].childNodes[3].childNodes[0].childNodes[0].classList.add("inWatchlist")}}}(document.querySelectorAll(".card"))}))}(s)}document.getElementById("deleteTextBtn").addEventListener("click",(function(){e.value=""})),t&&t.addEventListener("click",o),document.addEventListener("DOMContentLoaded",(()=>{e.value="marvel",o(),e.value=""})),a.addEventListener("click",(function(){if("block"===s.style.display)i.innerHTML="",history.go(-1),s.style.display="none",c.style.minHeight="900px";else{history.pushState(null,null,"#favorites");for(let e=0;e<localStorage.length;e++){const t=localStorage.getItem(localStorage.key(e));i.innerHTML+=`<div class="card">${t}</div>`}document.querySelectorAll("#favorites .card-btn-favorietes").forEach((e=>{e.style.backgroundColor="#F2DD92"})),s.style.display="block",c.style.minHeight=s.offsetHeight+"px"}const e=Object.keys(localStorage),t=document.querySelectorAll("#favorites > .card");for(let n=0;n<t.length;n++)t[n].childNodes[1].childNodes[7].childNodes[1].childNodes[3].addEventListener("click",(t=>{t.target.closest("path").classList.remove("inWatchlist");const n=t.target.closest("div.card");console.log(l(e,`${n.id}key`)),l(e,`${n.id}key`)&&localStorage.removeItem(`${n.id}key`)}))}))})();